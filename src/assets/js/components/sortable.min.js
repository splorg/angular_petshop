/*! UIkit 3.14.1 | https://www.getuikit.com | (c) 2014 - 2022 YOOtheme | MIT License */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("uikit-util")):"function"==typeof define&&define.amd?define("uikitsortable",["uikit-util"],e):(t="undefined"!=typeof globalThis?globalThis:t||self).UIkitSortable=e(t.UIkit.util)}(this,(function(t){"use strict";function e(e){return function(e,s,n){const o=[[]];for(const r of e){if(!t.isVisible(r))continue;let e=i(r);for(let t=o.length-1;t>=0;t--){const a=o[t];if(!a[0]){a.push(r);break}let h;if(a[0].offsetParent===r.offsetParent?h=i(a[0]):(e=i(r,!0),h=i(a[0],!0)),e[s]>=h[n]-1&&e[s]!==h[s]){o.push([r]);break}if(e[n]-1>h[s]||e[s]===h[s]){a.push(r);break}if(0===t){o.unshift([r]);break}}}return o}(e,"top","bottom")}function i(e,i){void 0===i&&(i=!1);let{offsetTop:s,offsetLeft:n,offsetHeight:o,offsetWidth:r}=e;return i&&([s,n]=t.offsetPosition(e)),{top:s,left:n,bottom:s+o,right:n+r}}const s="uk-transition-leave",n="uk-transition-enter";function o(e,i,o,l){void 0===l&&(l=0);const c=r(i,!0),d={opacity:1},u={opacity:0},p=t=>()=>c===r(i)?t():Promise.reject(),m=p((()=>(t.addClass(i,s),Promise.all(h(i).map(((e,i)=>new Promise((s=>setTimeout((()=>t.Transition.start(e,u,o/2,"ease").then(s)),i*l)))))).then((()=>t.removeClass(i,s)))))),f=p((()=>{const s=t.height(i);return t.addClass(i,n),e(),t.css(t.children(i),{opacity:0}),new Promise((e=>requestAnimationFrame((()=>{const a=t.children(i),p=t.height(i);t.css(i,"alignContent","flex-start"),t.height(i,s);const m=h(i);t.css(a,u);const f=m.map(((e,i)=>new Promise((s=>setTimeout((()=>t.Transition.start(e,d,o/2,"ease").then(s)),i*l)))));s!==p&&f.push(t.Transition.start(i,{height:p},o/2+m.length*l,"ease")),Promise.all(f).then((()=>{t.removeClass(i,n),c===r(i)&&(t.css(i,{height:"",alignContent:""}),t.css(a,{opacity:""}),delete i.dataset.transition),e()}))}))))}));return t.hasClass(i,s)?a(i).then(f):t.hasClass(i,n)?a(i).then(m).then(f):m().then(f)}function r(e,i){return i&&(e.dataset.transition=1+r(e)),t.toNumber(e.dataset.transition)||0}function a(e){return Promise.all(t.children(e).filter(t.Transition.inProgress).map((e=>new Promise((i=>t.once(e,"transitionend transitioncanceled",i))))))}function h(i){return e(t.children(i)).reduce(((e,i)=>e.concat(t.sortBy(i.filter((e=>t.isInView(e))),"offsetLeft"))),[])}function l(e,i,s){return new Promise((n=>requestAnimationFrame((()=>{let o=t.children(i);const r=o.map((t=>c(t,!0))),a=t.css(i,["height","padding"]);t.Transition.cancel(i),o.forEach(t.Transition.cancel),d(i),e(),o=o.concat(t.children(i).filter((e=>!t.includes(o,e)))),Promise.resolve().then((()=>{t.fastdom.flush();const e=t.css(i,["height","padding"]),[h,l]=function(e,i,s){const n=i.map(((e,i)=>!(!t.parent(e)||!(i in s))&&(s[i]?t.isVisible(e)?u(e):{opacity:0}:{opacity:t.isVisible(e)?1:0}))),o=n.map(((n,o)=>{const r=t.parent(i[o])===e&&(s[o]||c(i[o]));if(!r)return!1;if(n){if(!("opacity"in n)){const{opacity:t}=r;t%1?n.opacity=1:delete r.opacity}}else delete r.opacity;return r}));return[n,o]}(i,o,r);o.forEach(((e,i)=>l[i]&&t.css(e,l[i]))),t.css(i,{display:"block",...a}),requestAnimationFrame((()=>{const r=o.map(((e,n)=>t.parent(e)===i&&t.Transition.start(e,h[n],s,"ease"))).concat(t.Transition.start(i,e,s,"ease"));Promise.all(r).then((()=>{o.forEach(((e,s)=>t.parent(e)===i&&t.css(e,"display",0===h[s].opacity?"none":""))),d(i)}),t.noop).then(n)}))}))}))))}function c(e,i){const s=t.css(e,"zIndex");return!!t.isVisible(e)&&{display:"",opacity:i?t.css(e,"opacity"):"0",pointerEvents:"none",position:"absolute",zIndex:"auto"===s?t.index(e):s,...u(e)}}function d(e){t.css(e.children,{height:"",left:"",opacity:"",pointerEvents:"",position:"",top:"",marginTop:"",marginLeft:"",transform:"",width:"",zIndex:""}),t.css(e,{height:"",display:"",padding:""})}function u(e){const{height:i,width:s}=t.offset(e),{top:n,left:o}=t.position(e),{marginLeft:r,marginTop:a}=t.css(e,["marginTop","marginLeft"]);return{top:n,left:o,height:i,width:s,marginLeft:r,marginTop:a,transform:""}}var p={props:{duration:Number,animation:Boolean},data:{duration:150,animation:"slide"},methods:{animate(e,i){void 0===i&&(i=this.$el);const s=this.animation,n="fade"===s?o:"delayed-fade"===s?function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return o(...e,40)}:s?l:()=>(e(),Promise.resolve());return n(e,i,this.duration).then((()=>this.$update(i,"resize")),t.noop)}}},m={mixins:[{connected(){!t.hasClass(this.$el,this.$name)&&t.addClass(this.$el,this.$name)}},p],props:{group:String,threshold:Number,clsItem:String,clsPlaceholder:String,clsDrag:String,clsDragState:String,clsBase:String,clsNoDrag:String,clsEmpty:String,clsCustom:String,handle:String},data:{group:!1,threshold:5,clsItem:"uk-sortable-item",clsPlaceholder:"uk-sortable-placeholder",clsDrag:"uk-sortable-drag",clsDragState:"uk-drag",clsBase:"uk-sortable",clsNoDrag:"uk-sortable-nodrag",clsEmpty:"uk-sortable-empty",clsCustom:"",handle:!1,pos:{}},created(){for(const e of["init","start","move","end"]){const i=this[e];this[e]=e=>{t.assign(this.pos,t.getEventPos(e)),i(e)}}},events:{name:t.pointerDown,passive:!1,handler:"init"},computed:{target(){return(this.$el.tBodies||[this.$el])[0]},items(){return t.children(this.target)},isEmpty:{get(){return t.isEmpty(this.items)},watch(e){t.toggleClass(this.target,this.clsEmpty,e)},immediate:!0},handles:{get(e,i){let{handle:s}=e;return s?t.$$(s,i):this.items},watch(e,i){t.css(i,{touchAction:"",userSelect:""}),t.css(e,{touchAction:t.hasTouch?"none":"",userSelect:"none"})},immediate:!0}},update:{write(e){if(!this.drag||!t.parent(this.placeholder))return;const{pos:{x:i,y:s},origin:{offsetTop:n,offsetLeft:o},placeholder:r}=this;t.css(this.drag,{top:s-n,left:i-o});const a=this.getSortable(document.elementFromPoint(i,s));if(!a)return;const{items:h}=a;if(h.some(t.Transition.inProgress))return;const l=function(e,i){return e[t.findIndex(e,(e=>t.pointInRect(i,e.getBoundingClientRect())))]}(h,{x:i,y:s});if(h.length&&(!l||l===r))return;const c=this.getSortable(r),d=function(e,i,s,n,o,r){if(!t.children(e).length)return;const a=i.getBoundingClientRect();if(!r)return function(e,i){const s=1===t.children(e).length;s&&t.append(e,i);const n=t.children(e),o=n.some(((t,e)=>{const i=t.getBoundingClientRect();return n.slice(e+1).some((t=>{const e=t.getBoundingClientRect();return!g([i.left,i.right],[e.left,e.right])}))}));s&&t.remove(i);return o}(e,s)||o<a.top+a.height/2?i:i.nextElementSibling;const h=s.getBoundingClientRect(),l=g([a.top,a.bottom],[h.top,h.bottom]),c=l?n:o,d=l?"width":"height",u=l?"left":"top",p=l?"right":"bottom",m=h[d]<a[d]?a[d]-h[d]:0;if(h[u]<a[u])return!(m&&c<a[u]+m)&&i.nextElementSibling;if(m&&c>a[p]-m)return!1;return i}(a.target,l,r,i,s,a===c&&e.moved!==l);!1!==d&&(d&&r===d||(a!==c?(c.remove(r),e.moved=l):delete e.moved,a.insert(r,d),this.touched.add(a)))},events:["move"]},methods:{init(e){const{target:i,button:s,defaultPrevented:n}=e,[o]=this.items.filter((e=>t.within(i,e)));!o||n||s>0||t.isInput(i)||t.within(i,"."+this.clsNoDrag)||this.handle&&!t.within(i,this.handle)||(e.preventDefault(),this.touched=new Set([this]),this.placeholder=o,this.origin={target:i,index:t.index(o),...this.pos},t.on(document,t.pointerMove,this.move),t.on(document,t.pointerUp,this.end),this.threshold||this.start(e))},start(e){this.drag=function(e,i){const s=t.append(e,i.outerHTML.replace(/(^<)(?:li|tr)|(?:li|tr)(\/>$)/g,"$1div$2"));return t.css(s,"margin","0","important"),t.css(s,{boxSizing:"border-box",width:i.offsetWidth,height:i.offsetHeight,padding:t.css(i,"padding")}),t.height(s.firstElementChild,t.height(i.firstElementChild)),s}(this.$container,this.placeholder);const{left:i,top:s}=this.placeholder.getBoundingClientRect();t.assign(this.origin,{offsetLeft:this.pos.x-i,offsetTop:this.pos.y-s}),t.addClass(this.drag,this.clsDrag,this.clsCustom),t.addClass(this.placeholder,this.clsPlaceholder),t.addClass(this.items,this.clsItem),t.addClass(document.documentElement,this.clsDragState),t.trigger(this.$el,"start",[this,this.placeholder]),function(e){let i=Date.now();f=setInterval((()=>{let{x:s,y:n}=e;n+=t.scrollTop(window);const o=.3*(Date.now()-i);i=Date.now(),t.scrollParents(document.elementFromPoint(s,e.y),/auto|scroll/).reverse().some((e=>{let{scrollTop:i,scrollHeight:s}=e;const{top:r,bottom:a,height:h}=t.offsetViewport(e);if(r<n&&r+35>n)i-=o;else{if(!(a>n&&a-35<n))return;i+=o}if(i>0&&i<s-h)return t.scrollTop(e,i),!0}))}),15)}(this.pos),this.move(e)},move(t){this.drag?this.$emit("move"):(Math.abs(this.pos.x-this.origin.x)>this.threshold||Math.abs(this.pos.y-this.origin.y)>this.threshold)&&this.start(t)},end(){if(t.off(document,t.pointerMove,this.move),t.off(document,t.pointerUp,this.end),!this.drag)return;clearInterval(f);const e=this.getSortable(this.placeholder);this===e?this.origin.index!==t.index(this.placeholder)&&t.trigger(this.$el,"moved",[this,this.placeholder]):(t.trigger(e.$el,"added",[e,this.placeholder]),t.trigger(this.$el,"removed",[this,this.placeholder])),t.trigger(this.$el,"stop",[this,this.placeholder]),t.remove(this.drag),this.drag=null;for(const{clsPlaceholder:e,clsItem:i}of this.touched)for(const s of this.touched)t.removeClass(s.items,e,i);this.touched=null,t.removeClass(document.documentElement,this.clsDragState)},insert(e,i){t.addClass(this.items,this.clsItem);this.animate((()=>i?t.before(i,e):t.append(this.target,e)))},remove(e){t.within(e,this.target)&&this.animate((()=>t.remove(e)))},getSortable(e){do{const t=this.$getComponent(e,"sortable");if(t&&(t===this||!1!==this.group&&t.group===this.group))return t}while(e=t.parent(e))}}};let f;function g(t,e){return t[1]>e[0]&&e[1]>t[0]}return"undefined"!=typeof window&&window.UIkit&&window.UIkit.component("sortable",m),m}));
